
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>thermalnoise</title><meta name="generator" content="MATLAB 9.8"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2021-04-01"><meta name="DC.source" content="thermalnoise.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>thermalnoise</h1><!--introduction--><p>Calculates acoustic pressure thermal noise from a library of algorithms.</p><p>---</p><pre>  NL = thermalnoise(method, T, rho, c, f, df, {a});</pre><p>Calculates thermal noise level using algorithm name METHOD with</p><pre>NL         float             Noise Level [dB]
T          float             Medium Temperature [K]
rho        float             Medium Density [kg/m^3]
c          float             Medium Compressional Sound Speed [m/s]
f          float             Frequency [Hz]
df         float             Frequency Interval [Hz]
a          float             Radius (Piston/Sphere) [m]
method     char              Algorithm Name (case &amp; special character non-sensitive)</pre><p>where method is any of:</p><pre>* 'Mellen' for thermal noise at a point
* 'Callen-Welton' for thermal noise on the surface of a sphere
* 'Sivian-White' for thermal noise on the surface of a piston</pre><p>All equation implementations have been vectorized.</p><p>---</p><pre>  tn = thermalnoise(methods, t, rho, c, f, df, {a});</pre><p>Calculates thermal noise level using the algorithms listed in METHODS where</p><pre>tn          struct            Structure with fields of method names containing the thermal noise level
methods     cell of chars     Cell with chars of algorithm names</pre><p>---</p><pre>  tn = thermalnoise(T, rho, c, f, df, {a});</pre><p>Calculates thermal noise level using all valid algorithms for the combination of input parameters given.</p><p>---</p><pre>  thermalnoise</pre><p>Call with no arguments to run the examples.</p><p>---</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Configuration</a></li><li><a href="#2">References</a></li><li><a href="#3">Implementation (Source Code)</a></li></ul></div><h2 id="1">Configuration</h2><pre>Author: Aaron Kaw
Date: 1/4/2021</pre><pre>MATLAB Version: 9.8.0.1396136 (R2020a) Update 3
Operating System: Microsoft Windows 10 Enterprise Version 10.0 (Build 19042)
Java Version: Java 1.8.0_202-b08 with Oracle Corporation Java HotSpot(TM) 64-Bit Server VM mixed mode</pre><h2 id="2">References</h2><p>[1] Readhead, M. L. (2014, October). Is underwater thermal noise useful?. In <i>Inter-Noise and Noise-Con Congress and Conference Proceedings</i> (Vol. 249, No. 2, pp. 4978-4983). Institute of Noise Control Engineering.</p><h2 id="3">Implementation (Source Code)</h2><pre class="codeinput"><span class="keyword">function</span> tn = thermalnoise(varargin)

	algs = struct( <span class="keyword">...</span>
		<span class="string">'mellen'</span>, @(p) Mellen(p.T, p.rho, p.c, p.f, p.df), <span class="keyword">...</span>
		<span class="string">'callenwelton'</span>, @(p) CallenWelton(p.T, p.rho, p.c, p.f, p.df, p.a), <span class="keyword">...</span>
		<span class="string">'sivianwhite'</span>, @(p) SivianWhite(p.T, p.rho, p.c, p.f, p.df, p.a) <span class="keyword">...</span>
		);

	pars = {<span class="string">'T'</span>, <span class="string">'rho'</span>, <span class="string">'c'</span>, <span class="string">'f'</span>, <span class="string">'df'</span>, <span class="string">'a'</span>};

	<span class="keyword">if</span> nargin == 0
		example(<span class="string">'Air'</span>)
		example(<span class="string">'Water'</span>)
		<span class="keyword">return</span>
	<span class="keyword">end</span>

	<span class="keyword">switch</span> class(varargin{1})
		<span class="keyword">case</span> <span class="string">'char'</span>
			m = lower(varargin{1}(isletter(varargin{1})));
			p = struct();
			<span class="keyword">for</span> n = 1:length(varargin)-1
				p.(pars{n}) = varargin{n + 1};
			<span class="keyword">end</span>
			tn = 20*log10(sqrt(algs.(m)(p))/1e-6);

		<span class="keyword">case</span> <span class="string">'cell'</span>
			methods = varargin{1};
			<span class="keyword">for</span> n = 1:length(methods)
				m = lower(methods{n}(isletter(methods{n})));
				<span class="keyword">try</span>
					tn.(m) = thermalnoise(m, varargin{2:end});
				<span class="keyword">catch</span> E
					<span class="keyword">if</span> ~strcmp(E.message, <span class="string">'Reference to non-existent field ''a''.'</span>)
						error(E.message)
					<span class="keyword">end</span>
				<span class="keyword">end</span>
			<span class="keyword">end</span>

		<span class="keyword">case</span> <span class="string">'double'</span>
			tn = struct();
			tn = thermalnoise(fields(algs), varargin{:});

		<span class="keyword">otherwise</span>
			error(<span class="string">'Unrecognized class of first input argument.'</span>)
	<span class="keyword">end</span>
<span class="keyword">end</span>

<span class="comment">% Algorithms</span>
<span class="keyword">function</span> p_ms = Mellen(T, rho, c, f, df)
	<span class="comment">% Mean-square noise pressure in water at a point [1]. Also derived by Callen &amp; Welton as vanishing</span>
	<span class="comment">% sphere [1].</span>
	p_ms = 4*pi*k_B*T.*rho.*f.^2.*df./c;
<span class="keyword">end</span>

<span class="keyword">function</span> p_ms = CallenWelton(T, rho, c, f, df, a)
	<span class="comment">% Mean-square fluctuating pressure averaged over spherical surface [1].</span>
	k = 2*pi*f./c;
	p_ms = 4.*pi.*k_B.*T.*rho.*f.^2./c./(1 + (k.*a).^2).*df;
<span class="keyword">end</span>

<span class="keyword">function</span> p_ms = SivianWhite(T, rho, c, f, df, a)
	<span class="comment">% mean-square thermal acoustic pressure in air averaged over piston in infinite wall [1].</span>
	k = 2*pi*f./c;
	p_ms = 4*k_B*T.*rho.*c/pi./a.^2*(1 - besselj(1, 2*k.*a)./k./a).*df;
<span class="keyword">end</span>

<span class="comment">% Auxiliary Functions</span>
<span class="keyword">function</span> val = k_B
	<span class="comment">% Boltzmann's constant in J/K.</span>
	val = 1.380649e-23;
<span class="keyword">end</span>

<span class="comment">% Examples</span>
<span class="keyword">function</span> example(medium)
	<span class="keyword">switch</span> medium
		<span class="keyword">case</span> <span class="string">'Air'</span>
			rho = 1.2041; <span class="comment">% kg/m^3</span>
			c = 343; <span class="comment">% m/s</span>
		<span class="keyword">case</span> <span class="string">'Water'</span>
			rho = 1027.3;
			c = 1500;
	<span class="keyword">end</span>

	f = 10.^(linspace(log10(1e3), log10(1000e3))); <span class="comment">% Hz</span>
	T = 4 + 273.15; <span class="comment">% K</span>
	df = 1e5; <span class="comment">% Hz</span>
	a = 1e-2; <span class="comment">% m</span>

	tn = thermalnoise(T, rho, c, f, df, a);

	figure
	hold <span class="string">on</span>
	<span class="keyword">for</span> method = fields(tn)'
		m = method{:};
		plot( <span class="keyword">...</span>
			f, tn.(m), <span class="keyword">...</span>
			<span class="string">'DisplayName'</span>, m <span class="keyword">...</span>
			)
	<span class="keyword">end</span>
	legend(<span class="string">'Location'</span>, <span class="string">'NorthWest'</span>)
	title([<span class="string">'Acoustic Pressure Thermal Noise: '</span> medium])
	xlabel(<span class="string">'Frequency [Hz]'</span>)
	ylabel(<span class="string">'Thermal Noise [dB]'</span>)
	set(gca, <span class="string">'xscale'</span>, <span class="string">'log'</span>)
	grid <span class="string">on</span>
<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="thermalnoise_01.png" alt=""> <img vspace="5" hspace="5" src="thermalnoise_02.png" alt=""> <p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2020a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% thermalnoise
% Calculates acoustic pressure thermal noise from a library of algorithms.
%
% REPLACE_WITH_DASH_DASH-
% 
%    NL = thermalnoise(method, T, rho, c, f, df, {a});
%
% Calculates thermal noise level using algorithm name METHOD with
%
%  NL         float             Noise Level [dB]
%  T          float             Medium Temperature [K]
%  rho        float             Medium Density [kg/m^3]
%  c          float             Medium Compressional Sound Speed [m/s]
%  f          float             Frequency [Hz]
%  df         float             Frequency Interval [Hz]
%  a          float             Radius (Piston/Sphere) [m]
%  method     char              Algorithm Name (case & special character non-sensitive)
%
% where method is any of:
%
%  * 'Mellen' for thermal noise at a point
%  * 'Callen-Welton' for thermal noise on the surface of a sphere
%  * 'Sivian-White' for thermal noise on the surface of a piston
%
% All equation implementations have been vectorized.
%
% REPLACE_WITH_DASH_DASH-
% 
%    tn = thermalnoise(methods, t, rho, c, f, df, {a});
%
% Calculates thermal noise level using the algorithms listed in METHODS where
%
%  tn          struct            Structure with fields of method names containing the thermal noise level
%  methods     cell of chars     Cell with chars of algorithm names
%
% REPLACE_WITH_DASH_DASH-
% 
%    tn = thermalnoise(T, rho, c, f, df, {a});
%
% Calculates thermal noise level using all valid algorithms for the combination of input parameters
% given.
%
% REPLACE_WITH_DASH_DASH-
% 
%    thermalnoise
%
% Call with no arguments to run the examples.
% 
% REPLACE_WITH_DASH_DASH-

%% Configuration
%  Author: Aaron Kaw
%  Date: 1/4/2021
%
%  MATLAB Version: 9.8.0.1396136 (R2020a) Update 3
%  Operating System: Microsoft Windows 10 Enterprise Version 10.0 (Build 19042)
%  Java Version: Java 1.8.0_202-b08 with Oracle Corporation Java HotSpot(TM) 64-Bit Server VM mixed mode

%% References
% [1] Readhead, M. L. (2014, October). Is underwater thermal noise useful?. In _Inter-Noise and Noise-Con Congress and Conference Proceedings_ (Vol. 249, No. 2, pp. 4978-4983). Institute of Noise Control Engineering.

%% Implementation (Source Code)
function tn = thermalnoise(varargin)
	
	algs = struct( ...
		'mellen', @(p) Mellen(p.T, p.rho, p.c, p.f, p.df), ...
		'callenwelton', @(p) CallenWelton(p.T, p.rho, p.c, p.f, p.df, p.a), ...
		'sivianwhite', @(p) SivianWhite(p.T, p.rho, p.c, p.f, p.df, p.a) ...
		);
	
	pars = {'T', 'rho', 'c', 'f', 'df', 'a'};
	
	if nargin == 0
		example('Air')
		example('Water')
		return
	end
	
	switch class(varargin{1})
		case 'char'
			m = lower(varargin{1}(isletter(varargin{1})));
			p = struct();
			for n = 1:length(varargin)-1
				p.(pars{n}) = varargin{n + 1};
			end
			tn = 20*log10(sqrt(algs.(m)(p))/1e-6);
			
		case 'cell'
			methods = varargin{1};
			for n = 1:length(methods)
				m = lower(methods{n}(isletter(methods{n})));
				try
					tn.(m) = thermalnoise(m, varargin{2:end});
				catch E
					if ~strcmp(E.message, 'Reference to non-existent field ''a''.')
						error(E.message)
					end
				end
			end
			
		case 'double'
			tn = struct();
			tn = thermalnoise(fields(algs), varargin{:});
			
		otherwise
			error('Unrecognized class of first input argument.')
	end
end

% Algorithms
function p_ms = Mellen(T, rho, c, f, df)
	% Mean-square noise pressure in water at a point [1]. Also derived by Callen & Welton as vanishing
	% sphere [1].
	p_ms = 4*pi*k_B*T.*rho.*f.^2.*df./c;
end

function p_ms = CallenWelton(T, rho, c, f, df, a)
	% Mean-square fluctuating pressure averaged over spherical surface [1].
	k = 2*pi*f./c;
	p_ms = 4.*pi.*k_B.*T.*rho.*f.^2./c./(1 + (k.*a).^2).*df;
end

function p_ms = SivianWhite(T, rho, c, f, df, a)
	% mean-square thermal acoustic pressure in air averaged over piston in infinite wall [1].
	k = 2*pi*f./c;
	p_ms = 4*k_B*T.*rho.*c/pi./a.^2*(1 - besselj(1, 2*k.*a)./k./a).*df;
end

% Auxiliary Functions
function val = k_B
	% Boltzmann's constant in J/K.
	val = 1.380649e-23;
end

% Examples
function example(medium)
	switch medium
		case 'Air'
			rho = 1.2041; % kg/m^3
			c = 343; % m/s
		case 'Water'
			rho = 1027.3;
			c = 1500;
	end
	
	f = 10.^(linspace(log10(1e3), log10(1000e3))); % Hz
	T = 4 + 273.15; % K
	df = 1e5; % Hz
	a = 1e-2; % m
	
	tn = thermalnoise(T, rho, c, f, df, a);
	
	figure
	hold on
	for method = fields(tn)'
		m = method{:};
		plot( ...
			f, tn.(m), ...
			'DisplayName', m ...
			)
	end
	legend('Location', 'NorthWest')
	title(['Acoustic Pressure Thermal Noise: ' medium])
	xlabel('Frequency [Hz]')
	ylabel('Thermal Noise [dB]')
	set(gca, 'xscale', 'log')
	grid on
end
##### SOURCE END #####
--></body></html>